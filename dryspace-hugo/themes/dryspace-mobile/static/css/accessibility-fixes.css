/**
 * Accessibility Fixes and Enhancements
 * Dr. Amara Johnson-Liu's Implementation
 * 
 * Fixes color contrast issues, enhances focus indicators,
 * and provides comprehensive accessibility improvements
 */

/* ==========================================================================
   1. COLOR CONTRAST FIXES
   ========================================================================== */

/* Fix light gray text on white (was 2.8:1, now 4.5:1) */
.text-muted {
    color: #6c757d !important; /* Darker gray for better contrast */
}

/* Fix primary blue on light backgrounds */
.text-primary {
    color: #0056b3 !important; /* Darker blue for better contrast */
}

.bg-primary {
    background-color: #0056b3 !important;
}

.btn-primary {
    background-color: #0056b3 !important;
    border-color: #0056b3 !important;
}

.btn-primary:hover,
.btn-primary:focus {
    background-color: #004494 !important;
    border-color: #004494 !important;
}

/* Fix warning text contrast */
.text-warning {
    color: #856404 !important; /* Darker yellow for text */
}

.bg-warning {
    background-color: #ffc107 !important;
    color: #212529 !important; /* Dark text on yellow background */
}

.badge.bg-warning {
    color: #212529 !important;
}

/* Fix danger/red text contrast */
.text-danger {
    color: #dc3545 !important;
}

/* Ensure sufficient contrast for links */
a {
    color: #0056b3;
    text-decoration: underline;
}

a:hover,
a:focus {
    color: #004494;
}

/* Navigation link contrast */
.navbar-light .navbar-nav .nav-link {
    color: #212529 !important;
}

.navbar-light .navbar-nav .nav-link:hover,
.navbar-light .navbar-nav .nav-link:focus {
    color: #0056b3 !important;
}

/* Footer link contrast */
.site-footer a.text-muted {
    color: #adb5bd !important; /* Lighter gray for dark background */
}

.site-footer a.text-muted:hover,
.site-footer a.text-muted:focus {
    color: #fff !important;
}

/* ==========================================================================
   2. FOCUS INDICATORS
   ========================================================================== */

/* Universal focus indicator */
*:focus-visible {
    outline: 3px solid #0080ff !important;
    outline-offset: 2px !important;
}

/* Dark background focus indicators */
.bg-dark *:focus-visible,
.bg-danger *:focus-visible,
.bg-primary *:focus-visible {
    outline-color: #fff !important;
}

/* Button focus states */
.btn:focus-visible {
    box-shadow: 0 0 0 0.25rem rgba(0, 128, 255, 0.25) !important;
}

/* Form control focus */
.form-control:focus,
.form-select:focus {
    border-color: #0080ff !important;
    box-shadow: 0 0 0 0.25rem rgba(0, 128, 255, 0.25) !important;
}

/* ==========================================================================
   3. VISUALLY HIDDEN UTILITY
   ========================================================================== */

.visually-hidden,
.sr-only {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
}

/* ==========================================================================
   4. SKIP LINKS
   ========================================================================== */

.skip-link {
    position: absolute;
    left: -9999px;
    z-index: 9999;
    padding: 1rem 2rem;
    background: #0056b3;
    color: white;
    text-decoration: none;
    border-radius: 0 0 0.5rem 0;
    font-weight: 600;
}

.skip-link:focus {
    left: 0;
    top: 0;
    color: white;
    text-decoration: none;
}

/* ==========================================================================
   5. TOUCH TARGET SIZES
   ========================================================================== */

/* Ensure minimum 44x44px touch targets */
.btn {
    min-height: 44px;
    min-width: 44px;
    padding: 0.75rem 1rem;
}

.btn-sm {
    min-height: 44px;
    padding: 0.5rem 0.75rem;
}

.nav-link {
    min-height: 44px;
    display: flex;
    align-items: center;
    padding: 0.75rem 1rem;
}

.form-control,
.form-select {
    min-height: 44px;
}

/* Social media links */
.social-link {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: 50%;
}

/* ==========================================================================
   6. HIGH CONTRAST MODE SUPPORT
   ========================================================================== */

@media (prefers-contrast: high) {
    /* Add borders to improve visibility */
    .card,
    .btn,
    .form-control,
    .form-select,
    .dropdown-menu {
        border: 2px solid currentColor !important;
    }
    
    /* Increase font weights */
    body {
        font-weight: 500;
    }
    
    h1, h2, h3, h4, h5, h6,
    .fw-bold,
    .btn {
        font-weight: 700 !important;
    }
    
    /* Ensure links are underlined */
    a {
        text-decoration: underline !important;
    }
    
    /* High contrast focus indicators */
    *:focus-visible {
        outline: 4px solid currentColor !important;
        outline-offset: 2px !important;
    }
}

/* ==========================================================================
   7. REDUCED MOTION SUPPORT
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
    
    /* Disable parallax effects */
    .parallax {
        transform: none !important;
    }
    
    /* Disable smooth scroll */
    html {
        scroll-behavior: auto !important;
    }
}

/* ==========================================================================
   8. ICON ACCESSIBILITY
   ========================================================================== */

/* Ensure decorative icons are hidden from screen readers */
i[aria-hidden="true"],
.fa[aria-hidden="true"],
.fas[aria-hidden="true"],
.far[aria-hidden="true"],
.fab[aria-hidden="true"] {
    speak: none;
}

/* Icons used as buttons need proper sizing */
.icon-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 44px;
    min-height: 44px;
    padding: 0.5rem;
    cursor: pointer;
}

/* ==========================================================================
   9. FORM ACCESSIBILITY
   ========================================================================== */

/* Required field indicators */
.required {
    color: #dc3545;
    font-weight: 600;
}

/* Error messages */
.error-message,
.invalid-feedback {
    color: #dc3545;
    font-size: 0.875rem;
    margin-top: 0.25rem;
    display: block;
}

/* Success messages */
.success-message,
.valid-feedback {
    color: #28a745;
    font-size: 0.875rem;
    margin-top: 0.25rem;
    display: block;
}

/* Form labels */
label {
    font-weight: 600;
    margin-bottom: 0.5rem;
    display: block;
}

/* Fieldset and legend styling */
fieldset {
    border: 1px solid #dee2e6;
    border-radius: 0.25rem;
    padding: 1rem;
    margin-bottom: 1rem;
}

legend {
    font-weight: 700;
    font-size: 1.1rem;
    padding: 0 0.5rem;
    width: auto;
}

/* ==========================================================================
   10. HEADING STRUCTURE
   ========================================================================== */

/* Ensure proper heading hierarchy visual distinction */
h1 { font-size: 2.5rem; font-weight: 700; }
h2 { font-size: 2rem; font-weight: 700; }
h3 { font-size: 1.75rem; font-weight: 600; }
h4 { font-size: 1.5rem; font-weight: 600; }
h5 { font-size: 1.25rem; font-weight: 600; }
h6 { font-size: 1rem; font-weight: 600; }

/* ==========================================================================
   11. LOADING STATES
   ========================================================================== */

/* Loading spinner accessibility */
.spinner-border {
    vertical-align: middle;
}

.spinner-border + .visually-hidden {
    margin-left: 0.5rem;
}

/* Busy states */
[aria-busy="true"] {
    cursor: wait;
    opacity: 0.7;
}

/* ==========================================================================
   12. PRINT STYLES
   ========================================================================== */

@media print {
    /* Ensure good contrast in print */
    * {
        color: #000 !important;
        background: #fff !important;
    }
    
    /* Hide interactive elements */
    .btn,
    .skip-link,
    .animation-control-global,
    [role="navigation"],
    .d-print-none {
        display: none !important;
    }
    
    /* Show link URLs */
    a[href]::after {
        content: " (" attr(href) ")";
    }
    
    /* Ensure headings are bold */
    h1, h2, h3, h4, h5, h6 {
        font-weight: bold !important;
        page-break-after: avoid;
    }
    
    /* Avoid page breaks in cards */
    .card {
        page-break-inside: avoid;
    }
}

/* ==========================================================================
   13. RESPONSIVE ACCESSIBILITY
   ========================================================================== */

/* Mobile-specific accessibility improvements */
@media (max-width: 768px) {
    /* Larger touch targets on mobile */
    .btn,
    .nav-link,
    .form-control,
    .form-select {
        min-height: 48px;
    }
    
    /* Better spacing for touch */
    .btn + .btn,
    .form-control + .form-control {
        margin-top: 0.5rem;
    }
    
    /* Ensure readable font sizes */
    body {
        font-size: 16px; /* Prevent zoom on iOS */
    }
    
    .small,
    small {
        font-size: 0.875rem;
    }
}

/* ==========================================================================
   14. LANGUAGE SUPPORT
   ========================================================================== */

/* RTL language support */
[dir="rtl"] {
    text-align: right;
}

[dir="rtl"] .text-start {
    text-align: right !important;
}

[dir="rtl"] .text-end {
    text-align: left !important;
}

/* Language-specific fonts */
:lang(ar) {
    font-family: 'Arial', 'Helvetica', sans-serif;
}

:lang(zh) {
    font-family: 'Microsoft YaHei', 'SimHei', sans-serif;
}

/* ==========================================================================
   15. EMERGENCY FIXES
   ========================================================================== */

/* Fix any remaining contrast issues */
.bg-light {
    background-color: #f8f9fa !important;
}

.bg-light .text-muted {
    color: #495057 !important;
}

/* Ensure interactive elements are distinguishable */
button:not(.btn) {
    min-height: 44px;
    padding: 0.5rem 1rem;
    border: 2px solid currentColor;
    background: transparent;
    cursor: pointer;
}

/* Fix placeholder contrast */
::placeholder {
    color: #6c757d !important;
    opacity: 1 !important;
}